### 分布式部署测试

### 1. 检查节点健康状态
GET http://localhost:8081/api/subtitles/health/node
Accept: application/json

### 2. 在节点1提交任务
POST http://localhost:8081/api/subtitles/burn-url-srt/async
Content-Type: multipart/form-data; boundary=WebAppBoundary

--WebAppBoundary
Content-Disposition: form-data; name="taskId"

distributed_test_node1_001
--WebAppBoundary
Content-Disposition: form-data; name="videoUrl"

https://example.com/test-video-1.mp4
--WebAppBoundary
Content-Disposition: form-data; name="subtitleFile"; filename="subtitle1.srt"
Content-Type: text/plain

1
00:00:01,000 --> 00:00:03,000
节点1处理的任务

2
00:00:04,000 --> 00:00:06,000
测试分布式任务处理

--WebAppBoundary--

### 3. 在节点2查询任务状态（跨节点查询）
GET http://localhost:8081/api/subtitles/task/distributed_test_node1_001
Accept: application/json

### 4. 在节点2提交另一个任务
POST http://localhost:8081/api/subtitles/burn-url-srt/async
Content-Type: multipart/form-data; boundary=WebAppBoundary2

--WebAppBoundary2
Content-Disposition: form-data; name="taskId"

distributed_test_node2_002
--WebAppBoundary2
Content-Disposition: form-data; name="videoUrl"

https://example.com/test-video-2.mp4
--WebAppBoundary2
Content-Disposition: form-data; name="subtitleFile"; filename="subtitle2.srt"
Content-Type: text/plain

1
00:00:01,000 --> 00:00:03,000
节点2处理的任务

2
00:00:04,000 --> 00:00:06,000
验证负载均衡效果

--WebAppBoundary2--

### 5. 在节点1查询节点2的任务（跨节点查询）
GET http://localhost:8081/api/subtitles/task/distributed_test_node2_002
Accept: application/json

### 6. 检查全局任务统计
GET http://localhost:8081/api/subtitles/tasks/count
Accept: application/json

### 7. 检查节点2的健康状态
GET http://localhost:8081/api/subtitles/health/node
Accept: application/json

### 8. 测试任务ID冲突（应该失败）
POST http://localhost:8082/api/subtitles/burn-url-srt/async
Content-Type: multipart/form-data; boundary=WebAppBoundary3

--WebAppBoundary3
Content-Disposition: form-data; name="taskId"

distributed_test_node1_001
--WebAppBoundary3
Content-Disposition: form-data; name="videoUrl"

https://example.com/test-video-3.mp4
--WebAppBoundary3
Content-Disposition: form-data; name="subtitleFile"; filename="subtitle3.srt"
Content-Type: text/plain

1
00:00:01,000 --> 00:00:03,000
这个任务应该失败，因为ID冲突

--WebAppBoundary3--

### 9. 负载均衡测试 - 通过负载均衡器访问
POST http://localhost/api/subtitles/burn-url-srt/async
Content-Type: multipart/form-data; boundary=WebAppBoundary4

--WebAppBoundary4
Content-Disposition: form-data; name="taskId"

load_balanced_task_003
--WebAppBoundary4
Content-Disposition: form-data; name="videoUrl"

https://example.com/test-video-lb.mp4
--WebAppBoundary4
Content-Disposition: form-data; name="subtitleFile"; filename="subtitle_lb.srt"
Content-Type: text/plain

1
00:00:01,000 --> 00:00:03,000
通过负载均衡器提交的任务

2
00:00:04,000 --> 00:00:06,000
测试集群负载分发

--WebAppBoundary4--

### 10. 通过负载均衡器查询任务状态
GET http://localhost/api/subtitles/task/load_balanced_task_003
Accept: application/json

###
